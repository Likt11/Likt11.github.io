<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <link rel="manifest" href="/images/manifest.json">
  <meta name="msapplication-config" content="/images/browserconfig.xml">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta name="google-site-verification" content="KRqm7Lu_cZK-ZkctKdb9ybG_kBgFXWDh41mUPXdJNd8">
  <meta name="msvalidate.01" content="true">
  <meta name="yandex-verification" content="true">
  <meta name="baidu-site-verification" content="codeva-KIwwTfWo4R">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"likt11.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideDownBigOut"}},"path":"search.xml"};
  </script>

  <meta name="description" content="网络层学习中的一些总结">
<meta property="og:type" content="article">
<meta property="og:title" content="网络层基础总结">
<meta property="og:url" content="http://likt11.github.io/2024/05/17/%E7%BD%91%E7%BB%9C%E5%B1%82%E5%9F%BA%E7%A1%80%E6%80%BB%E7%BB%93/index.html">
<meta property="og:site_name" content="Likt&#39;s Blog">
<meta property="og:description" content="网络层学习中的一些总结">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-05-17T09:50:14.000Z">
<meta property="article:modified_time" content="2024-10-16T09:27:30.490Z">
<meta property="article:author" content="Likt">
<meta property="article:tag" content="网络层">
<meta property="article:tag" content="IP协议">
<meta property="article:tag" content="计算机网络">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://likt11.github.io/2024/05/17/%E7%BD%91%E7%BB%9C%E5%B1%82%E5%9F%BA%E7%A1%80%E6%80%BB%E7%BB%93/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>网络层基础总结 | Likt's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style><link rel="alternate" href="/atom.xml" title="Likt's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Likt's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">天空一直都在，是云来了又去。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://likt11.github.io/2024/05/17/%E7%BD%91%E7%BB%9C%E5%B1%82%E5%9F%BA%E7%A1%80%E6%80%BB%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Likt">
      <meta itemprop="description" content="请你务必，一而再，再而三，三而不竭，千次万次，毫不犹豫地救自己于这世间水火。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Likt's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          网络层基础总结
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-05-17 17:50:14" itemprop="dateCreated datePublished" datetime="2024-05-17T17:50:14+08:00">2024-05-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-10-16 17:27:30" itemprop="dateModified" datetime="2024-10-16T17:27:30+08:00">2024-10-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" itemprop="url" rel="index"><span itemprop="name">学习记录</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" itemprop="url" rel="index"><span itemprop="name">计算机网络</span></a>
                </span>
            </span>

          
            <span id="/2024/05/17/%E7%BD%91%E7%BB%9C%E5%B1%82%E5%9F%BA%E7%A1%80%E6%80%BB%E7%BB%93/" class="post-meta-item leancloud_visitors" data-flag-title="网络层基础总结" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2024/05/17/%E7%BD%91%E7%BB%9C%E5%B1%82%E5%9F%BA%E7%A1%80%E6%80%BB%E7%BB%93/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/05/17/%E7%BD%91%E7%BB%9C%E5%B1%82%E5%9F%BA%E7%A1%80%E6%80%BB%E7%BB%93/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>8.1k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>15 分钟</span>
            </span>
            <div class="post-description">网络层学习中的一些总结</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="4-1-网络层的几个重要概念"><a href="#4-1-网络层的几个重要概念" class="headerlink" title="4.1 网络层的几个重要概念"></a>4.1 网络层的几个重要概念</h2><h3 id="4-1-1-网络层提供的两种服务"><a href="#4-1-1-网络层提供的两种服务" class="headerlink" title="4.1.1.网络层提供的两种服务"></a>4.1.1.网络层提供的两种服务</h3><h4 id="虚电路服务VC——面向连接"><a href="#虚电路服务VC——面向连接" class="headerlink" title="虚电路服务VC——面向连接"></a>虚电路服务VC——面向连接</h4><p>双方沿着已建立的虚电路发送分组，这样的分组的首部不需要填写完整的目的主机地址，而只需要填写这条虚电路的编号，因而减少了分组的开销。</p>
<h4 id="数据报服务——无连接"><a href="#数据报服务——无连接" class="headerlink" title="数据报服务——无连接"></a>数据报服务——无连接</h4><p>数据报即分组</p>
<p>IP数据报和IP分组是同义词</p>
<p>网络在发送分组时不需要先建立联系，每个分组独立发送，与其前后的分组无关（不进行编号）</p>
<p>互联网的设计思路：网络层要设计的尽量简单，向其上层只提供简单灵活的、无连接的、尽最大努力交付的数据报服务。网络层不提供服务质量的承诺。</p>
<p>主机进程之间的可靠通信，由主机中的运输层负责（包括差错处理，流量控制）</p>
<p><strong>两种服务的对比</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>对比方面</th>
<th>虚电路服务</th>
<th>数据报服务</th>
</tr>
</thead>
<tbody>
<tr>
<td>思路</td>
<td>可靠通信应当由网络来保证</td>
<td>可靠通信由用户主机来保证</td>
</tr>
<tr>
<td>连接 的建立</td>
<td>必须有</td>
<td>不建立连接</td>
</tr>
<tr>
<td>终点地址</td>
<td>仅在建立连接阶段使用，每个分组使用短的虚电路号</td>
<td>每个分组都有终点的完整地址，即IP地址</td>
</tr>
<tr>
<td>分组的转发</td>
<td>同一条虚电路，即同一条路由</td>
<td>每个分组独立查找转发表进行转发</td>
</tr>
<tr>
<td>当节点出故障时</td>
<td>所有通过出故障的节点的虚电路均不能工作</td>
<td>出故障的节点可能丢失分组，一些路由可能变化</td>
</tr>
<tr>
<td>分组的顺序</td>
<td>总按顺序到达终点</td>
<td>到达终点顺序不一定按发送的顺序</td>
</tr>
<tr>
<td>端到端的差错处理和流量控制</td>
<td>可以由网络负责，也可以用户主机负责</td>
<td>用户主机负责</td>
</tr>
</tbody>
</table>
</div>
<h3 id="网络层的两个层面"><a href="#网络层的两个层面" class="headerlink" title="网络层的两个层面"></a>网络层的两个层面</h3><h4 id="一、数据层面"><a href="#一、数据层面" class="headerlink" title="一、数据层面"></a>一、数据层面</h4><p>转发源主机和目的主机之间所传送的数据（即分组像接力赛跑般在路由器之间(通过路由转发表）进行转发）</p>
<h4 id="二、控制层面"><a href="#二、控制层面" class="headerlink" title="二、控制层面"></a>二、控制层面</h4><p>传送路由信息，根据路由选择协议使用的算法彼此不断交换路由信息分组</p>
<h2 id="4-2网际协议IP"><a href="#4-2网际协议IP" class="headerlink" title="4.2网际协议IP"></a>4.2网际协议IP</h2><p>三个配套协议</p>
<p><strong>地址解析协议ARP</strong></p>
<p><strong>网际控制报文协议ICMP</strong></p>
<p><strong>网际组管理协议ICMP</strong></p>
<h3 id="4-2-1虚拟互连网络"><a href="#4-2-1虚拟互连网络" class="headerlink" title="4.2.1虚拟互连网络"></a>4.2.1虚拟互连网络</h3><p>即逻辑互连网络，因为，互连起来的各种物理网络的异构性是客观存在的。在网络层上看起来好像是一个统一的网络。</p>
<p>互联网可以由多种异构网络互连组成。</p>
<h5 id="介绍四种不同的中间设备"><a href="#介绍四种不同的中间设备" class="headerlink" title="介绍四种不同的中间设备"></a>介绍四种不同的中间设备</h5><ul>
<li>物理层使用的中间设备叫做转发器</li>
<li>数据链路层使用的中间设备叫做网桥或桥接器，交换机</li>
<li>网络层使用的中间设备叫做路由器</li>
<li>网络层以上使用的中间设备叫作网关</li>
</ul>
<p>直接交付、间接交付（需经过路由器）</p>
<h3 id="4-2-2-IP地址"><a href="#4-2-2-IP地址" class="headerlink" title="4.2.2 IP地址"></a>4.2.2 IP地址</h3><p>IP地址即：给连接到互联网上的每个主机（或路由器）的每个接口分配一个全世界范围内唯一的32位标识符（IPv4）。IP地址指明了连接到某个网络上的一个主机（或路由器）</p>
<p>点分十进制表示——（每八位）提高可读性</p>
<p><strong>网络号+主机号</strong></p>
<h4 id="分类的IP地址"><a href="#分类的IP地址" class="headerlink" title="分类的IP地址"></a>分类的IP地址</h4><div class="table-container">
<table>
<thead>
<tr>
<th>分类</th>
<th>IP</th>
<th>对应二进制</th>
</tr>
</thead>
<tbody>
<tr>
<td>A:</td>
<td>1-126</td>
<td>0</td>
</tr>
<tr>
<td>B</td>
<td>128-191</td>
<td>10</td>
</tr>
<tr>
<td>C:</td>
<td>192-223</td>
<td>110</td>
</tr>
<tr>
<td>D:多播地址</td>
<td>224-</td>
<td>1110</td>
</tr>
<tr>
<td>E:保留使用</td>
<td></td>
<td>1111</td>
</tr>
<tr>
<td>广播地址</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>网络号全为0，的IP地址，表示本网络任意地址，</p>
<p>网络号127保留作为本地软件环回测试</p>
<h4 id="无分类编址CIDR"><a href="#无分类编址CIDR" class="headerlink" title="无分类编址CIDR"></a>无分类编址CIDR</h4><p>无分类域间路由选择</p>
<h5 id="网络前缀"><a href="#网络前缀" class="headerlink" title="网络前缀"></a>网络前缀</h5><p>IP地址=网络前缀n+主机号(32-n)</p>
<p>n可以是0-32间任意取值，不是固定的数</p>
<h5 id="地址块"><a href="#地址块" class="headerlink" title="地址块"></a>地址块</h5><p>CIDR把网络前缀都相同的所有连续的IP地址组成一个CIDR地址块，所包含的IP地址数目取决于网络前缀的位数</p>
<p>例如：128.14.35.7/20表示的地址范围：</p>
<p>128.14.35.7/20=<code>10000000 00001110 0010</code>0011 00000111</p>
<div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th>点分十进制</th>
<th>二进制表示</th>
</tr>
</thead>
<tbody>
<tr>
<td>最小地址</td>
<td>128.14.32.0</td>
<td><code>10000000 00001110 0010</code>0000 00000000</td>
</tr>
<tr>
<td>最大地址</td>
<td>128.14.47.0</td>
<td><code>10000000 00001110 0010</code>1111 00000111</td>
</tr>
</tbody>
</table>
</div>
<h5 id="地址掩码"><a href="#地址掩码" class="headerlink" title="地址掩码"></a>地址掩码</h5><p>CIDR的斜线记法，斜线后面的数字就是地址掩码中1的个数</p>
<p>将IP地址同掩码进行与运算可以得到其网络地址</p>
<p>关于与运算：1 AND 1=1,1 AND 0=0,0 AND 0=0,</p>
<h5 id="CIDR的三个特殊地址块"><a href="#CIDR的三个特殊地址块" class="headerlink" title="CIDR的三个特殊地址块"></a>CIDR的三个特殊地址块</h5><ul>
<li>前缀n=32，没有主机号，是一个特殊的IP地址，用于主机路由</li>
<li>n=31，该地址块只有两个IP地址，用于点对点链路</li>
<li>n=0，同时IP地址全是0，即0.0.0.0/0，用于默认路由</li>
</ul>
<p>CIDR地址块可以看成包含多个C类地址，故称CIDR编址为“构造超网”</p>
<p>路由聚合：一个大的地址块中往往包含多个小地址块，故在路由表中利用较大 的CIDR地址块来代替很多小的地址块，减少了查找转发表所需时间。</p>
<p>网络前缀越短的地址块包含的地址数就越多。</p>
<h4 id="IP地址的特点"><a href="#IP地址的特点" class="headerlink" title="IP地址的特点"></a>IP地址的特点</h4><ul>
<li>前缀+主机号</li>
<li>路由器根据目的主机连接的网络前缀来转发分组，缩短了查找转发表时间</li>
<li>多归属主机（标志一台主机或路由器和一条链路的接口）</li>
<li>一个网络是指 具有相同网络前缀的主机的集合，用转发器或交换机连接起来的若干个局域网仍为一个网络，</li>
<li>IP地址中，所有分配到网络前缀的网络都是平等的，同等对待每个IP地址。</li>
<li>路由器每个接口的网络前缀不同，路由器相连时，一段连线，/31地址块，点对点链路构成特殊网络，无编号网络（匿名网络）</li>
</ul>
<h3 id="4-2-3IP地址和Mac地址"><a href="#4-2-3IP地址和Mac地址" class="headerlink" title="4.2.3IP地址和Mac地址"></a>4.2.3IP地址和Mac地址</h3><p>Mac地址固化在网卡的ROM中，硬件地址、物理地址，是数据链路层使用的地址，48位</p>
<p>IP地址是网络层和以上各层使用的地址，逻辑地址，IPv4为32位</p>
<p>IP地址放在IP数据报的首部，Mac地址放在Mac地址的首部，当IP数据报插入到数据链路层的Mac帧后，整个IP数据报就成为Mac帧的数据。——封装</p>
<p>数据报传输过程中：</p>
<ul>
<li>IP数据报的源目的IP地址不变</li>
<li>在局域网的链路层，只能看见Mac帧，传输过程中，Mac帧的源目的地址会发生变化。</li>
<li>IP层抽象的互联网屏蔽了下层复杂细节，在网络层讨论问题，即使用统一抽象的IP地址研究主机路由器之间的通信。</li>
</ul>
<h3 id="4-2-4地址解析协议ARP"><a href="#4-2-4地址解析协议ARP" class="headerlink" title="4.2.4地址解析协议ARP"></a>4.2.4地址解析协议ARP</h3><p>实际网络的链路上传送数据帧时，最终必须使用链路层的Mac地址，  </p>
<p>主机的Mac地址实际就是其网络适配器的Mac地址，地址解析协议：通过在主机的ARP高速缓存表中存放一个从IP地址到Mac地址的映射表，且这个映射表时常更新（新增或超时删除），映射地址项目都设置有一定生存时间</p>
<p>每个主机都设有一个ARP高速缓存表，里面存有本局域网上个主机和路由器的IP地址和Mac地址的映射表                      </p>
<p>如果在主机A在缓存表中找不到主机B的Mac地址值，如何知道其Mac地址呢？——前提A,B处于同一局域网</p>
<ul>
<li>A在本局域网上广播发送一个ARP请求分组（格式：我的IP地址为，Mac地址是，我想知道IP地址为 的主机的Mac地址）</li>
<li>主机B收到arp请求，发现IP地址和arp请求分组中要查询的IP地址一致，于是收下arp请求分组，（会将A的IP和Mac对应关系写入arp高速缓存），并向A发送arp响应分组（响应分组中有自己的Mac地址）</li>
<li>A收到响应分组，将B的IP和Mac对应关系写入arp高速缓存。</li>
<li>广播请求——单播响应</li>
</ul>
<p>如果在主机A在缓存表中找不到主机B的Mac地址值，如何知道其Mac地址呢？——前提A,B不在同一局域网</p>
<ul>
<li>A在本网络中发送arp请求分组 查找同一网络上的一台路由器的Mac地址，然后接下来的转发有路由器来完成</li>
<li>arp的多次反复使用</li>
</ul>
<p>从IP地址到Mac地址的解析是自动进行的，主机的用户对这种地址解析过程不知道，只要主机和本网络一个已知IP地址的主机或路由器要进行通信，协议ARP会自动将IP地址解析为链路层所需的Mac地址，然后插入到Mac帧中。</p>
<h3 id="4-2-5IP数据报的格式"><a href="#4-2-5IP数据报的格式" class="headerlink" title="4.2.5IP数据报的格式"></a>4.2.5IP数据报的格式</h3><p>IP数据报==&gt;首部+数据部分</p>
<p>首部格式的宽度为32位，即4字节，首部==固定部分20字节+可变部分</p>
<h5 id="固定部分："><a href="#固定部分：" class="headerlink" title="固定部分："></a>固定部分：</h5><ul>
<li>版本：占4位，IPv4:0100        IPv6:0110</li>
<li>首部长度：占4位，首部字段的最小值是5（0101），</li>
<li>区分服务：占8位，</li>
<li>总长度：<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="15.489ex" height="2.072ex" role="img" focusable="false" viewBox="0 -833.9 6846.1 915.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z" transform="translate(500,0)"></path></g></g></g><g data-mml-node="mo" transform="translate(1512.3,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(2512.6,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mo" transform="translate(3290.3,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(4346.1,0)"><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" transform="translate(500,0)"></path><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" transform="translate(1000,0)"></path><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z" transform="translate(1500,0)"></path><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" transform="translate(2000,0)"></path></g></g></g></svg></mjx-container>指首部和数据之和的长度，单位为字节，总长度字段为16位，</li>
</ul>
<p>在IP层下面的每一种数据链路层协议都规定了一个数据帧中的数据字段的最大长度，称为最大传送单元MTU，如果过长，需要进行对数据报进行分片处理。</p>
<ul>
<li>标识：16位，相同标识字段 使分片后的各数据报片最后能正确重装为原来的数据报</li>
<li>标志：3位，<ul>
<li>MF=1表示后面还有分片，MF=0表示这是若干数据报片的最后一个</li>
<li>DF 表示不能分片，DF=0时才允许分片</li>
</ul>
</li>
<li>片偏移：占13位，分片后，某片在原分组中的相对位置，（片偏移以8个字节为偏移单位</li>
<li>生存时间TTL：占8位，数据报在网络中的寿命，每经过一个路由器就减一，当其减为0时，就丢弃这个数据报。</li>
<li>协议：8位，</li>
<li>首部校验和：16位，只检验数据报的首部，不包括数据部分</li>
</ul>
<h5 id="可变部分"><a href="#可变部分" class="headerlink" title="可变部分"></a>可变部分</h5><p>增加IP数据报的功能，增加了路由器处理数据报的开销</p>
<h2 id="4-3-IP层转发分组的过程"><a href="#4-3-IP层转发分组的过程" class="headerlink" title="4.3 IP层转发分组的过程"></a>4.3 IP层转发分组的过程</h2><h4 id="基于终点的转发"><a href="#基于终点的转发" class="headerlink" title="基于终点的转发"></a>基于终点的转发</h4><h4 id="最长前缀匹配"><a href="#最长前缀匹配" class="headerlink" title="最长前缀匹配"></a>最长前缀匹配</h4><p>前缀越长，地址块越小，路由越具体</p>
<p>主机路由：a.b.c.d/32 在转发表中都放在最前面，对网络的连接或转发表进行排错时，指明到某一台主机的特殊路由就十分有用</p>
<p>默认路由：0.0.0.0/0</p>
<p>转发表分组转发算法：（假定转发表按照前缀的长短排列，把前缀长的放前面）</p>
<ul>
<li>从分组中提取目标地址D</li>
<li>看是否有特定主机路由，否者从转发表下一行开始检查</li>
<li>将该行子网掩码同D进行按位与运算</li>
<li>匹配，则结束</li>
<li>若默认路由，……</li>
</ul>
<h2 id="4-4-网际控制报文协议ICMP"><a href="#4-4-网际控制报文协议ICMP" class="headerlink" title="4.4 网际控制报文协议ICMP"></a>4.4 网际控制报文协议ICMP</h2><p>ICMP允许主机或路由器报告差错情况和提供有关异常情况的报告</p>
<p>ICMP数据报装在IP数据报中，作为其中的数据部分，是IP层的协议</p>
<h4 id="4-4-1ICMP报文的种类"><a href="#4-4-1ICMP报文的种类" class="headerlink" title="4.4.1ICMP报文的种类"></a>4.4.1ICMP报文的种类</h4><ul>
<li>ICMP差错报告报文</li>
<li>ICMP询问报文</li>
</ul>
<p>前四字节是统一格式：共有三个字段，类型、代码、校验和、而后四个字节内容同ICMP类型有关，最后是数据字段，长度取决于ICMP的类型</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>ICMP报文种类</th>
<th>类型的值</th>
<th>ICMP报文的类型</th>
</tr>
</thead>
<tbody>
<tr>
<td>差错报告报文</td>
<td>3</td>
<td>终点不可达</td>
</tr>
<tr>
<td></td>
<td>11</td>
<td>时间超时（如果当生存时间为0时，没有收到一个数据报的全部数据报片，将丢弃所有的已收到的数据报片，并向源点发送时间超时报文</td>
</tr>
<tr>
<td></td>
<td>12</td>
<td>参数问题</td>
</tr>
<tr>
<td></td>
<td>5</td>
<td>改变路由redirect</td>
</tr>
<tr>
<td>询问报文</td>
<td>8或0</td>
<td>回送echo请求或回送回答（向特定主机发出询问，收到此报文的主机必须回送回答报文）</td>
</tr>
<tr>
<td></td>
<td>13或14</td>
<td>时间戳请求或时间戳回答（时间戳：报文的发送和接收时间，计算往返时间</td>
</tr>
</tbody>
</table>
</div>
<p>不应发送ICMP差错报告报文的几种情况：</p>
<ul>
<li>对ICMP差错报告报文，不再发送ICMP差错报告报文</li>
<li>对第一个分片的数据报片的所有后续数据报片，都不发送ICMP差错报告报文</li>
<li>对具有多播地址的数据报，不发送ICMP差错报告报文</li>
<li>对具有特殊地址的数据报127.0.0.0或0.0.0.0，不发送ICMP差错报告报文</li>
</ul>
<h3 id="4-4-2-ICMP的应用举例"><a href="#4-4-2-ICMP的应用举例" class="headerlink" title="4.4.2 ICMP的应用举例"></a>4.4.2 ICMP的应用举例</h3><h4 id="ping（分组网间探测"><a href="#ping（分组网间探测" class="headerlink" title="ping（分组网间探测"></a>ping（分组网间探测</h4><p>用来测试两台主机之间连通性，使用了ICMP回送请求和回送回答报文，是应用层直接使用网络层ICMP的一个例子，没有通过传输层的tcp或udp</p>
<p>ping 127.0.0.1</p>
<h4 id="tracert"><a href="#tracert" class="headerlink" title="tracert"></a>tracert</h4><p>traceroute从源主机向目的主机发送一系列IP数据报，数据报中封装的是无法交付的udp用户数据报，第一个数据报TTL=1，第二个TTL=2，……，（每个TTL值，源主机会发送三次（当TTL=0时，发送ICMP时间超过差错报告报文</p>
<h4 id="攻击：伪装成目标主机，导致网络中大量主机向目标主机发送"><a href="#攻击：伪装成目标主机，导致网络中大量主机向目标主机发送" class="headerlink" title="攻击：伪装成目标主机，导致网络中大量主机向目标主机发送"></a>攻击：伪装成目标主机，导致网络中大量主机向目标主机发送</h4><ul>
<li>死亡之ping</li>
<li>ping -t -l 65550（缓冲区溢出</li>
<li>smurf攻击</li>
<li>重定向攻击</li>
</ul>
<h2 id="4-5-IPv6"><a href="#4-5-IPv6" class="headerlink" title="4.5 IPv6"></a>4.5 IPv6</h2><p>将协议数据单元PDU称为分组，而不是IPv4中的数据报。</p>
<p>变化：</p>
<ul>
<li>更大地址空间，128位</li>
<li>扩展的地址层次结构</li>
<li>灵活的首部格式（可选的扩展首部</li>
<li>改进的选项（允许数据报包含有选项的控制信息，IPv6的首部长度固定，其选项放在有效载荷中</li>
<li>允许协议继续扩充</li>
<li>支持即插即用（不需要DHCP</li>
<li>支持资源的预分配</li>
<li>IPv6首部改为8字节对齐（首部长度必须为8字节的整数倍（原来IPv4 是4字节对齐</li>
</ul>
<p>IPv6数据报==基本首部+有效载荷（亦称净负荷，有效载荷允许零个或多个扩展首部，再后面是数据部分</p>
<ul>
<li>取消了校验和字段，加快了路由器处理数据报的速度，在数据链路层对检测出有差错的帧就丢弃，运输层，当使用udp时，若检测出有差错的用户数据报就丢弃，当使用tcp时，对检测出有差错的报文段就重传，直到正确的传送到目的进程为止，因此在网络层的差错检测可以精简掉。</li>
<li>有效载荷长度</li>
<li>下一个首部：<ul>
<li>如果IPv6没有拓展首部，其作用和IPv4的协议字段一样，指出了基本首部后面的数据应交付IP层上面的哪个高层协议</li>
<li>出现拓展首部时，下一个首部字段 表示后面第一个扩展首部的类型，以此类推下一个首部</li>
</ul>
</li>
<li>跳数限制：hop limit</li>
</ul>
<h4 id="从IPv4向IPv6过渡"><a href="#从IPv4向IPv6过渡" class="headerlink" title="从IPv4向IPv6过渡"></a>从IPv4向IPv6过渡</h4><ul>
<li>双协议栈<ul>
<li>IPv6/IPv4</li>
<li>同时装有IPv4和IPv6两种协议栈</li>
</ul>
</li>
<li>隧道技术<ul>
<li>将IPv6数据报封装成为 IPv4数据报，即IPv6数据报变成了IPv4数据报的数据部分，最后再取出</li>
<li>必须将IPv4首部的协议字段的值设置为41（表示数据报的数据部分 是IPv6数据报</li>
</ul>
</li>
</ul>
<h4 id="ICMPv6"><a href="#ICMPv6" class="headerlink" title="ICMPv6"></a>ICMPv6</h4><p>利用报文来报告差错，获取信息，探测邻站或管理多播通信</p>
<p>ARP和IGMP的功能都已被合并到ICMPv6中</p>
<ul>
<li>差错报文</li>
<li>信息报文</li>
<li>邻站发现报文（ND协议</li>
<li>组成员关系报文（MLD协议</li>
</ul>
<h2 id="4-6-互联网的路由选择协议"><a href="#4-6-互联网的路由选择协议" class="headerlink" title="4.6 互联网的路由选择协议"></a>4.6 互联网的路由选择协议</h2><h3 id="4-6-1-路由协议算法的几个概念"><a href="#4-6-1-路由协议算法的几个概念" class="headerlink" title="4.6.1 路由协议算法的几个概念"></a>4.6.1 路由协议算法的几个概念</h3><h4 id="理想的路由算法："><a href="#理想的路由算法：" class="headerlink" title="理想的路由算法："></a>理想的路由算法：</h4><ul>
<li>算法必须完整且正确</li>
<li>在计算上简单</li>
<li>能适应通信量和网络拓扑的变化——稳健性</li>
<li>稳定性，应收敛于一个可以接受的值</li>
<li>公平性（对于除优先级高的用户</li>
<li>最佳的（特定要求下较为合理的选择</li>
</ul>
<p><strong>静态路由选择策略——非自适应路由选择：简单，开销小，不能即使适应网络状态的变化，需要人工配置每一条路由，适用于简单的网络</strong></p>
<p><strong>动态路由选择策略——自适应路由选择：实现比较复杂，能够适应网络的变化，开销大，适用于比较复杂的大网络</strong></p>
<h4 id="分层次的路由选择协议"><a href="#分层次的路由选择协议" class="headerlink" title="分层次的路由选择协议"></a>分层次的路由选择协议</h4><p>自治系统AS：每一个AS对于其他AS表现出的是一个单一的和一致的路由选择策略。</p>
<p>内部网关协议IGP：RIP,OSPF,IS-IS</p>
<p>外部网关协议EGP：BGP-4（边界网关协议</p>
<p>自治系统之间的路由选择叫做 域间路由选择，而在自治系统内部的路由选择叫做域内路由选择。</p>
<h3 id="4-6-2-内部网关协议RIP"><a href="#4-6-2-内部网关协议RIP" class="headerlink" title="4.6.2 内部网关协议RIP"></a>4.6.2 内部网关协议RIP</h3><p>RIP是一种分布式的基于距离向量的路由选择协议，最大的特点就是简单。</p>
<p>从路由器到直接连接的网络的距离定义为1，从一主机到非直接连接的网络的距离定义为所经过的路由器数加1，RIP协议的距离也称为“跳数”，RIP允许一条路径最多只能包含15个网络，因此距离等于16时相当于不可达。RIP只适用于小型互联网。RIP选择一条具有最少网络数的路由（即最短路由）</p>
<p>RIP协议的特点：</p>
<ul>
<li>仅和相邻路由器交换信息</li>
<li>路由器交换的信息时当前路由器所知道的全部信息，即自己现在的路由表</li>
<li>按固定的时间间隔交换路由信息，每隔30秒（主机也运行RIP，但是只是被动的接受从路由器发来的路由信息</li>
<li>RIP可以收敛，且较快，“收敛”即在自治系统中所有的节点都得到正确的路由选择信息的过程。</li>
<li>路由表更新的原则时找到到达每个网络的最短距离——距离矢量算法</li>
</ul>
<h4 id="距离矢量算法："><a href="#距离矢量算法：" class="headerlink" title="距离矢量算法："></a>距离矢量算法：</h4><p>路由表信息如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>目的网络</th>
<th>距离</th>
<th>下一跳路由器</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>三种更新路由情况：</p>
<ul>
<li>收到新的信息（即到达新的网络的路由信息</li>
<li>更短的路由信息</li>
<li>上层网络发生变化导致路由发生变化，无论远近必须更新。</li>
</ul>
<p>三种定时器：</p>
<ul>
<li>更新定时器 30秒</li>
<li>路由失效  180秒</li>
<li>清除路由条目  240秒</li>
</ul>
<p>协议RIP让一个自治系统中的所有路由器都和自己的相邻路由器定期交换路由信息，并不断更新路由表，使得每个路由器到每一个网络的路由都是最近的</p>
<p>RIP报文作为运输层用户数据报UDP的数据部分进行传送（使用UDP的端口520.)RIP报文由首部和路由部分组成，在路由部分要填入自治系统号ASN</p>
<p>坏消息传得慢：当网络故障时，可能需要很长时间才能将此信息传到所有路由器——路由环路问题</p>
<p>例如：某个网络发生故障无法抵达，需要很长时间才能传到所有路由器</p>
<p>解决路由环路问题：</p>
<ul>
<li>定义最大值</li>
<li>水平分割（即从某个路由器传来的路由信息 不能再传回去到该路由器（记住来源，不反向传播</li>
<li>毒性反转（将条数置为16</li>
<li>触发更新（不异30秒周期更新，一发生变化马上更新</li>
<li>HOLD DOWN计时器</li>
</ul>
<h3 id="4-6-3内部网关协议OSPF"><a href="#4-6-3内部网关协议OSPF" class="headerlink" title="4.6.3内部网关协议OSPF"></a>4.6.3内部网关协议OSPF</h3><p>开放最短路径优先OSPF</p>
<h4 id="协议OSPF的基本特点："><a href="#协议OSPF的基本特点：" class="headerlink" title="协议OSPF的基本特点："></a>协议OSPF的基本特点：</h4><ul>
<li>使用链路状态协议</li>
<li>向本自治系统中所有路由器发送信息（洪泛法</li>
<li>发送的信息是于本路由器相邻的所有路由器的<strong>链路状态</strong>（说明本路由器和哪些路由器相连，及该链路的“度量”—-<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -1.158ex;" xmlns="http://www.w3.org/2000/svg" width="21.657ex" height="3.431ex" role="img" focusable="false" viewBox="0 -1004.9 9572.2 1516.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">代</text></g><g data-mml-node="mi" transform="translate(1000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">价</text></g><g data-mml-node="mo" transform="translate(2277.8,0)"><g data-mml-node="text"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="text" transform="translate(778,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="text" transform="translate(1556,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g></g><g data-mml-node="mfrac" transform="translate(4889.6,0)"><g data-mml-node="msup" transform="translate(1833.4,394) scale(0.707)"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)"></path></g><g data-mml-node="mn" transform="translate(1033,393.1) scale(0.707)"><path data-c="38" d="M70 417T70 494T124 618T248 666Q319 666 374 624T429 515Q429 485 418 459T392 417T361 389T335 371T324 363L338 354Q352 344 366 334T382 323Q457 264 457 174Q457 95 399 37T249 -22Q159 -22 101 29T43 155Q43 263 172 335L154 348Q133 361 127 368Q70 417 70 494ZM286 386L292 390Q298 394 301 396T311 403T323 413T334 425T345 438T355 454T364 471T369 491T371 513Q371 556 342 586T275 624Q268 625 242 625Q201 625 165 599T128 534Q128 511 141 492T167 463T217 431Q224 426 228 424L286 386ZM250 21Q308 21 350 55T392 137Q392 154 387 169T375 194T353 216T330 234T301 253T274 270Q260 279 244 289T218 306L210 311Q204 311 181 294T133 239T107 157Q107 98 150 60T250 21Z"></path></g></g><g data-mml-node="mrow" transform="translate(220,-370.3) scale(0.707)"><g data-mml-node="mi"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">该</text></g><g data-mml-node="mi" transform="translate(1000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">链</text></g><g data-mml-node="mi" transform="translate(2000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">路</text></g><g data-mml-node="mi" transform="translate(3000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">的</text></g><g data-mml-node="mi" transform="translate(4000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">带</text></g><g data-mml-node="mi" transform="translate(5000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">宽</text></g></g><rect width="4442.6" height="60" x="120" y="220"></rect></g></g></g></svg></mjx-container></li>
<li>当链路状态发生变化或每隔一段时间（如30分钟），路由器向所有路由器用洪泛法发送链路状态信息</li>
</ul>
<p>链路状态数据库——实际上就是全网的网络拓扑结构图，在全网范围内是一致的（这称为链路状态数据库的同步）</p>
<p>OSPF的更新过程收敛快</p>
<p>OSPF将自治系统再划分为多个小区域，每个区域有32位的区域标识符（一个区域内的路由器不能超过二十个</p>
<p>OSPF使用层次结构的区域划分，上层的区域叫做主干区域（0.0.0.0：用来连通下层区域</p>
<p>区域边界路由器，主干路由器，自治系统边界路由器</p>
<h4 id="OSPF的五种分组类型"><a href="#OSPF的五种分组类型" class="headerlink" title="OSPF的五种分组类型"></a>OSPF的五种分组类型</h4><ol>
<li>问候分组 hello：用来发现和维持邻站的可达性（每隔10秒交换问候分组40秒没收到对方的问候分组，即认为该相邻路由器不可达</li>
<li>数据库描述分组 DD：给出自己的链路状态数据库中所有链路状态项目的摘要信息</li>
<li>链路状态请求分组LSR:向对方请求发送某些链路状态项目的详细信息</li>
<li>链路状态更新分组LSU:用洪泛法对全网更新链路状态</li>
<li>链路状态确认分组LSAck：对链路更新分组的确认</li>
</ol>
<p>2345分组都是为了实现链路状态数据库的同步：不同路由器的链路状态数据库中的内容是一样的，两个同步的路由器叫做“完全邻接的”</p>
<p>OSPF分组是作为IP数据报的数据部分来传送，（IP数据报首部的协议字段是89）OSPF构成的数据报很短，好处是不用分片，不会引起分片丢失导致的重传。</p>
<p>OSPF使用可靠的洪泛法向全网更新链路状态：收到更新分组后要发送确认（收到重复的更新分组只需确认一次）</p>
<p>指定路由器DR和备用指定路由器BDR:所有路由器只与DR进行链路状态交换构成同步————最终结果就是所有路由器达到同步</p>
<h3 id="4-6-4外部网关协议BGP"><a href="#4-6-4外部网关协议BGP" class="headerlink" title="4.6.4外部网关协议BGP"></a>4.6.4外部网关协议BGP</h3><p><code>pass</code></p>
<h3 id="4-9因特网的层次路由"><a href="#4-9因特网的层次路由" class="headerlink" title="4.9因特网的层次路由"></a>4.9因特网的层次路由</h3><h3 id="广播路由"><a href="#广播路由" class="headerlink" title="广播路由"></a>广播路由</h3><p>全网广播</p>
<p>受控制的洪泛：序号控制，记住转发过的最大编号，如果收到小于最大编号的数据报，因为已经广播过了，故采取丢弃。</p>
<h3 id="4-7组播路由——IP多播"><a href="#4-7组播路由——IP多播" class="headerlink" title="4.7组播路由——IP多播"></a>4.7组播路由——IP多播</h3><p>给一部分的主机发送</p>
<p>组播地址：224.0.0.0/24到239.255.255.255</p>
<p>用一个D类地址来标志一个多播组，故D类地址可以标志<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="2.919ex" height="1.887ex" role="img" focusable="false" viewBox="0 -833.9 1290.1 833.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path data-c="38" d="M70 417T70 494T124 618T248 666Q319 666 374 624T429 515Q429 485 418 459T392 417T361 389T335 371T324 363L338 354Q352 344 366 334T382 323Q457 264 457 174Q457 95 399 37T249 -22Q159 -22 101 29T43 155Q43 263 172 335L154 348Q133 361 127 368Q70 417 70 494ZM286 386L292 390Q298 394 301 396T311 403T323 413T334 425T345 438T355 454T364 471T369 491T371 513Q371 556 342 586T275 624Q268 625 242 625Q201 625 165 599T128 534Q128 511 141 492T167 463T217 431Q224 426 228 424L286 386ZM250 21Q308 21 350 55T392 137Q392 154 387 169T375 194T353 216T330 234T301 253T274 270Q260 279 244 289T218 306L210 311Q204 311 181 294T133 239T107 157Q107 98 150 60T250 21Z" transform="translate(500,0)"></path></g></g></g></g></g></svg></mjx-container>个多播组，多播数据报也是尽最大的努力交付，不能保证交付给多播组内的所有成员，多播数据报首部的协议字段是2，表明使用网际组管理协议IGMP</p>
<p>多播地址只能用于目的地址，不能用于源地址，此外对多播数据报 不产生ICMP差错报文，即”ping 多播地址 “永远得不到回应。</p>
<p>需要确定组成员，识别分组，组播树，使用IGMP来识别组，</p>
<p>更多见P179-P182</p>
<h2 id="4-8-虚拟专用网VPN和网络地址转换NAT"><a href="#4-8-虚拟专用网VPN和网络地址转换NAT" class="headerlink" title="4.8 虚拟专用网VPN和网络地址转换NAT"></a>4.8 虚拟专用网VPN和网络地址转换NAT</h2><p>专用地址，全局地址，</p>
<p>在互联网中的所有路由器，对目的地址的专用地址的数据报一律不进行转发。</p>
<p>私有地址块：</p>
<p>A:10.0.0.0/8该地址块相当于原来的一个A类网络，即从 10.0.0.0—-10.255.255.255</p>
<p>B:172.16.0.0/12该地址块相当于原来的16个连续的B类网络，即从172.16.0.0—-172.31.255.255</p>
<p>C:192.168.0.0/16该地址块相当于256给连续的C类网络，即从192.168.0.0—-192.168.255.255</p>
<h3 id="4-8-1虚拟专用网VPN"><a href="#4-8-1虚拟专用网VPN" class="headerlink" title="4.8.1虚拟专用网VPN"></a>4.8.1虚拟专用网VPN</h3><p>VPN是在效果上和真正的专用网一样。</p>
<p>利用IP隧道技术实现虚拟专用网：</p>
<ul>
<li>要求每个场所至少有一个路由器具有合法的全球IP地址，</li>
<li>对内部数据报进行加密（保证内部数据报的安全）重新加上数据报的首部，封装称为在互联网上发送的外部数据报，源和目的地址分别是两个路由器的公有地址，收到数据报后取出其中的数据部分，解密，恢复出内部数据报，交付给主机。</li>
<li>内联VPN（内部网络），外联VPN（需要外部机构加入）</li>
</ul>
<p>远程接入VPN：公司员工出差，远程工作的员工通过拨号接入互联网，驻留在员工个人电脑中的VPN软件可以在个人电脑和共公司主机之间建立VPN隧道。且通信内容也是保密的。</p>
<h3 id="4-8-2网络地址转换NAT"><a href="#4-8-2网络地址转换NAT" class="headerlink" title="4.8.2网络地址转换NAT"></a>4.8.2网络地址转换NAT</h3><p>NAT路由器，至少要有一个外部全球IP地址</p>
<ul>
<li>NAT转换表，将专有网中的IP地址和全球IP地址对应——缺陷</li>
<li>其通信只能由专用网内的主机发起，故专用网内部的主机不能直接充当服务器。</li>
<li>使用端口号的NAT—-网络地址于端口号转换NAPT</li>
</ul>

    </div>

    
    
    


<div>
  
    
<div>
    
        <div style="text-align:center;font-size:14px;">-------------本文结束感谢您的阅读-------------</div>
    
</div>
  
</div>
        <div class="reward-container">
  <div>情不知从所起，一往而深！</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.png" alt="Likt 微信支付">
        <p>微信支付</p>
      </div>

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Likt
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://likt11.github.io/2024/05/17/%E7%BD%91%E7%BB%9C%E5%B1%82%E5%9F%BA%E7%A1%80%E6%80%BB%E7%BB%93/" title="网络层基础总结">http://likt11.github.io/2024/05/17/网络层基础总结/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E7%BD%91%E7%BB%9C%E5%B1%82/" rel="tag"><i class="fa fa-tag"></i> 网络层</a>
              <a href="/tags/IP%E5%8D%8F%E8%AE%AE/" rel="tag"><i class="fa fa-tag"></i> IP协议</a>
              <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" rel="tag"><i class="fa fa-tag"></i> 计算机网络</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item"></div>
      <div class="post-nav-item">
    <a href="/2024/05/18/%E5%8A%A8%E6%80%81%E5%88%86%E5%8C%BA%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86%E5%AE%9E%E9%AA%8C/" rel="next" title="动态分区存储管理实验">
      动态分区存储管理实验 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-%E7%BD%91%E7%BB%9C%E5%B1%82%E7%9A%84%E5%87%A0%E4%B8%AA%E9%87%8D%E8%A6%81%E6%A6%82%E5%BF%B5"><span class="nav-number">1.</span> <span class="nav-text">4.1 网络层的几个重要概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-1-%E7%BD%91%E7%BB%9C%E5%B1%82%E6%8F%90%E4%BE%9B%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%9C%8D%E5%8A%A1"><span class="nav-number">1.1.</span> <span class="nav-text">4.1.1.网络层提供的两种服务</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%99%9A%E7%94%B5%E8%B7%AF%E6%9C%8D%E5%8A%A1VC%E2%80%94%E2%80%94%E9%9D%A2%E5%90%91%E8%BF%9E%E6%8E%A5"><span class="nav-number">1.1.1.</span> <span class="nav-text">虚电路服务VC——面向连接</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%8A%A5%E6%9C%8D%E5%8A%A1%E2%80%94%E2%80%94%E6%97%A0%E8%BF%9E%E6%8E%A5"><span class="nav-number">1.1.2.</span> <span class="nav-text">数据报服务——无连接</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E5%B1%82%E7%9A%84%E4%B8%A4%E4%B8%AA%E5%B1%82%E9%9D%A2"><span class="nav-number">1.2.</span> <span class="nav-text">网络层的两个层面</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E6%95%B0%E6%8D%AE%E5%B1%82%E9%9D%A2"><span class="nav-number">1.2.1.</span> <span class="nav-text">一、数据层面</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E6%8E%A7%E5%88%B6%E5%B1%82%E9%9D%A2"><span class="nav-number">1.2.2.</span> <span class="nav-text">二、控制层面</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2%E7%BD%91%E9%99%85%E5%8D%8F%E8%AE%AEIP"><span class="nav-number">2.</span> <span class="nav-text">4.2网际协议IP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-1%E8%99%9A%E6%8B%9F%E4%BA%92%E8%BF%9E%E7%BD%91%E7%BB%9C"><span class="nav-number">2.1.</span> <span class="nav-text">4.2.1虚拟互连网络</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BB%8B%E7%BB%8D%E5%9B%9B%E7%A7%8D%E4%B8%8D%E5%90%8C%E7%9A%84%E4%B8%AD%E9%97%B4%E8%AE%BE%E5%A4%87"><span class="nav-number">2.1.0.1.</span> <span class="nav-text">介绍四种不同的中间设备</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-2-IP%E5%9C%B0%E5%9D%80"><span class="nav-number">2.2.</span> <span class="nav-text">4.2.2 IP地址</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E7%B1%BB%E7%9A%84IP%E5%9C%B0%E5%9D%80"><span class="nav-number">2.2.1.</span> <span class="nav-text">分类的IP地址</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%A0%E5%88%86%E7%B1%BB%E7%BC%96%E5%9D%80CIDR"><span class="nav-number">2.2.2.</span> <span class="nav-text">无分类编址CIDR</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E5%89%8D%E7%BC%80"><span class="nav-number">2.2.2.1.</span> <span class="nav-text">网络前缀</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9C%B0%E5%9D%80%E5%9D%97"><span class="nav-number">2.2.2.2.</span> <span class="nav-text">地址块</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9C%B0%E5%9D%80%E6%8E%A9%E7%A0%81"><span class="nav-number">2.2.2.3.</span> <span class="nav-text">地址掩码</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#CIDR%E7%9A%84%E4%B8%89%E4%B8%AA%E7%89%B9%E6%AE%8A%E5%9C%B0%E5%9D%80%E5%9D%97"><span class="nav-number">2.2.2.4.</span> <span class="nav-text">CIDR的三个特殊地址块</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#IP%E5%9C%B0%E5%9D%80%E7%9A%84%E7%89%B9%E7%82%B9"><span class="nav-number">2.2.3.</span> <span class="nav-text">IP地址的特点</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-3IP%E5%9C%B0%E5%9D%80%E5%92%8CMac%E5%9C%B0%E5%9D%80"><span class="nav-number">2.3.</span> <span class="nav-text">4.2.3IP地址和Mac地址</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-4%E5%9C%B0%E5%9D%80%E8%A7%A3%E6%9E%90%E5%8D%8F%E8%AE%AEARP"><span class="nav-number">2.4.</span> <span class="nav-text">4.2.4地址解析协议ARP</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-5IP%E6%95%B0%E6%8D%AE%E6%8A%A5%E7%9A%84%E6%A0%BC%E5%BC%8F"><span class="nav-number">2.5.</span> <span class="nav-text">4.2.5IP数据报的格式</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9B%BA%E5%AE%9A%E9%83%A8%E5%88%86%EF%BC%9A"><span class="nav-number">2.5.0.1.</span> <span class="nav-text">固定部分：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%AF%E5%8F%98%E9%83%A8%E5%88%86"><span class="nav-number">2.5.0.2.</span> <span class="nav-text">可变部分</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3-IP%E5%B1%82%E8%BD%AC%E5%8F%91%E5%88%86%E7%BB%84%E7%9A%84%E8%BF%87%E7%A8%8B"><span class="nav-number">3.</span> <span class="nav-text">4.3 IP层转发分组的过程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E7%BB%88%E7%82%B9%E7%9A%84%E8%BD%AC%E5%8F%91"><span class="nav-number">3.0.1.</span> <span class="nav-text">基于终点的转发</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%80%E9%95%BF%E5%89%8D%E7%BC%80%E5%8C%B9%E9%85%8D"><span class="nav-number">3.0.2.</span> <span class="nav-text">最长前缀匹配</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-4-%E7%BD%91%E9%99%85%E6%8E%A7%E5%88%B6%E6%8A%A5%E6%96%87%E5%8D%8F%E8%AE%AEICMP"><span class="nav-number">4.</span> <span class="nav-text">4.4 网际控制报文协议ICMP</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-4-1ICMP%E6%8A%A5%E6%96%87%E7%9A%84%E7%A7%8D%E7%B1%BB"><span class="nav-number">4.0.1.</span> <span class="nav-text">4.4.1ICMP报文的种类</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-2-ICMP%E7%9A%84%E5%BA%94%E7%94%A8%E4%B8%BE%E4%BE%8B"><span class="nav-number">4.1.</span> <span class="nav-text">4.4.2 ICMP的应用举例</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ping%EF%BC%88%E5%88%86%E7%BB%84%E7%BD%91%E9%97%B4%E6%8E%A2%E6%B5%8B"><span class="nav-number">4.1.1.</span> <span class="nav-text">ping（分组网间探测</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#tracert"><span class="nav-number">4.1.2.</span> <span class="nav-text">tracert</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%94%BB%E5%87%BB%EF%BC%9A%E4%BC%AA%E8%A3%85%E6%88%90%E7%9B%AE%E6%A0%87%E4%B8%BB%E6%9C%BA%EF%BC%8C%E5%AF%BC%E8%87%B4%E7%BD%91%E7%BB%9C%E4%B8%AD%E5%A4%A7%E9%87%8F%E4%B8%BB%E6%9C%BA%E5%90%91%E7%9B%AE%E6%A0%87%E4%B8%BB%E6%9C%BA%E5%8F%91%E9%80%81"><span class="nav-number">4.1.3.</span> <span class="nav-text">攻击：伪装成目标主机，导致网络中大量主机向目标主机发送</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-5-IPv6"><span class="nav-number">5.</span> <span class="nav-text">4.5 IPv6</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%8EIPv4%E5%90%91IPv6%E8%BF%87%E6%B8%A1"><span class="nav-number">5.0.1.</span> <span class="nav-text">从IPv4向IPv6过渡</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ICMPv6"><span class="nav-number">5.0.2.</span> <span class="nav-text">ICMPv6</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-6-%E4%BA%92%E8%81%94%E7%BD%91%E7%9A%84%E8%B7%AF%E7%94%B1%E9%80%89%E6%8B%A9%E5%8D%8F%E8%AE%AE"><span class="nav-number">6.</span> <span class="nav-text">4.6 互联网的路由选择协议</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-6-1-%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE%E7%AE%97%E6%B3%95%E7%9A%84%E5%87%A0%E4%B8%AA%E6%A6%82%E5%BF%B5"><span class="nav-number">6.1.</span> <span class="nav-text">4.6.1 路由协议算法的几个概念</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%90%86%E6%83%B3%E7%9A%84%E8%B7%AF%E7%94%B1%E7%AE%97%E6%B3%95%EF%BC%9A"><span class="nav-number">6.1.1.</span> <span class="nav-text">理想的路由算法：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E5%B1%82%E6%AC%A1%E7%9A%84%E8%B7%AF%E7%94%B1%E9%80%89%E6%8B%A9%E5%8D%8F%E8%AE%AE"><span class="nav-number">6.1.2.</span> <span class="nav-text">分层次的路由选择协议</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-6-2-%E5%86%85%E9%83%A8%E7%BD%91%E5%85%B3%E5%8D%8F%E8%AE%AERIP"><span class="nav-number">6.2.</span> <span class="nav-text">4.6.2 内部网关协议RIP</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B7%9D%E7%A6%BB%E7%9F%A2%E9%87%8F%E7%AE%97%E6%B3%95%EF%BC%9A"><span class="nav-number">6.2.1.</span> <span class="nav-text">距离矢量算法：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-6-3%E5%86%85%E9%83%A8%E7%BD%91%E5%85%B3%E5%8D%8F%E8%AE%AEOSPF"><span class="nav-number">6.3.</span> <span class="nav-text">4.6.3内部网关协议OSPF</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%8F%E8%AE%AEOSPF%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%89%B9%E7%82%B9%EF%BC%9A"><span class="nav-number">6.3.1.</span> <span class="nav-text">协议OSPF的基本特点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#OSPF%E7%9A%84%E4%BA%94%E7%A7%8D%E5%88%86%E7%BB%84%E7%B1%BB%E5%9E%8B"><span class="nav-number">6.3.2.</span> <span class="nav-text">OSPF的五种分组类型</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-6-4%E5%A4%96%E9%83%A8%E7%BD%91%E5%85%B3%E5%8D%8F%E8%AE%AEBGP"><span class="nav-number">6.4.</span> <span class="nav-text">4.6.4外部网关协议BGP</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-9%E5%9B%A0%E7%89%B9%E7%BD%91%E7%9A%84%E5%B1%82%E6%AC%A1%E8%B7%AF%E7%94%B1"><span class="nav-number">6.5.</span> <span class="nav-text">4.9因特网的层次路由</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B9%BF%E6%92%AD%E8%B7%AF%E7%94%B1"><span class="nav-number">6.6.</span> <span class="nav-text">广播路由</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-7%E7%BB%84%E6%92%AD%E8%B7%AF%E7%94%B1%E2%80%94%E2%80%94IP%E5%A4%9A%E6%92%AD"><span class="nav-number">6.7.</span> <span class="nav-text">4.7组播路由——IP多播</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-8-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E7%BD%91VPN%E5%92%8C%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2NAT"><span class="nav-number">7.</span> <span class="nav-text">4.8 虚拟专用网VPN和网络地址转换NAT</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-8-1%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E7%BD%91VPN"><span class="nav-number">7.1.</span> <span class="nav-text">4.8.1虚拟专用网VPN</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-8-2%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2NAT"><span class="nav-number">7.2.</span> <span class="nav-text">4.8.2网络地址转换NAT</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Likt"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Likt</p>
  <div class="site-description" itemprop="description">请你务必，一而再，再而三，三而不竭，千次万次，毫不犹豫地救自己于这世间水火。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">18</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Likt</span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>
-->

<!-- 网站运行时间的设置 -->
<span id="timeDate">载入天数...</span>
<span id="times">载入时分秒...</span>
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("05/08/2024 10:11:00"); //此处修改你的建站时间或者网站上线时间
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 ";
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒.";
    }
setInterval("createtime()",250);
</script>


        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>

<script src="/js/utils.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : '5CGDgZL88OYzRNYj1PLjmcBc-gzGzoHsz',
      appKey     : 'N0AqOmhJqbysjAOoqieRu6Jv',
      placeholder: "期待与您的交流！",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>


  
  <style>
    .copy-btn {
      display: inline-block;
      padding: 6px 12px;
      font-size: 13px;
      font-weight: 700;
      line-height: 20px;
      color: #4D4D4C;
      white-space: nowrap;
      vertical-align: middle;
      cursor: pointer;
      background-color: #F7F7F7;
      background-image: linear-gradient(#F7F7F7, #F7F7F7);
      border: 1px solid #d5d5d5;
      border-radius: 3px;
      user-select: none;
      outline: 0;
    }

    .highlight-wrap .copy-btn {
      transition: opacity .3s ease-in-out;
      opacity: 0;
      padding: 2px 6px;
      position: absolute;
      right: 4px;
      top: 8px;
    }

    .highlight-wrap:hover .copy-btn,
    .highlight-wrap .copy-btn:focus {
      opacity: 1
    }

    .highlight-wrap {
      position: relative;
    }
  </style>

  <script>
    $('.highlight').each(function (i, e) {
      var $wrap = $('<div>').addClass('highlight-wrap')
      $(e).after($wrap)
      $wrap.append($('<button>').addClass('copy-btn').append('post.copy_button').on('click', function (e) {
        var code = $(this).parent().find('.code').find('.line').map(function (i, e) {
          return $(e).text()
        }).toArray().join('\n')
        var ta = document.createElement('textarea')
        document.body.appendChild(ta)
        ta.style.position = 'absolute'
        ta.style.top = '0px'
        ta.style.left = '0px'
        ta.value = code
        ta.select()
        ta.focus()
        var result = document.execCommand('copy')
        document.body.removeChild(ta)
        
          if(result)$(this).text('post.copy_success')
          else $(this).text('post.copy_failure')
        
        $(this).blur()
      })).on('mouseleave', function (e) {
        var $b = $(this).find('.copy-btn')
        setTimeout(function () {
          $b.text('post.copy_button')
        }, 300)
      }).append(e)
    })
  </script>


<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":200,"height":400},"mobile":{"show":true},"log":false});</script></body>
</html>
